<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="theme-color" content="#000000">
    
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/manifest.json">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#10b068">
    <meta name="theme-color" content="#ffffff">

    <meta property="og:site_name" content="Junctions" />
    <meta property="og:type" content="article" />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:creator" content="james_k_nelson" />
    <meta property="og:image" content="https://junctions.js.org/logo.png?2" />
    <meta name="twitter:image" content="https://junctions.js.org/logo.png?2" />
    <meta property="og:title" content="Build a static documentation site, with create-react-app and Junctions" />
    <meta name="twitter:title" content="Build a static documentation site, with create-react-app and Junctions" />
    <meta name="description" content="In this step-by-step tutorial, you'll build a small documentation website with static rendering -- just like this one!" />
    <meta property="og:description" content="In this step-by-step tutorial, you'll build a small documentation website with static rendering -- just like this one!" />
    <meta name="twitter:description" content="In this step-by-step tutorial, you'll build a small documentation website with static rendering -- just like this one!" />
    
    <title>Junctions Tutorial</title>
  <link rel="stylesheet" type="text/css" href="/static/css/main.8da2f98a.css" />
  <body>
    <noscript>
      You need to enable JavaScript to run this app.
    </noscript>
    <div id="root"><div id="JUNCTIONS_STATIC" data-reactroot=""><div class="App"><div class="App-nav "><div class="Sidebar App-nav-sidebar"><a href="/" class="Sidebar-brand "><img src="/static/media/logo.b0b8d42b.svg" class="Sidebar-brand-logo" alt="logo"/><span class="Sidebar-brand-title">Junctions</span></a><nav class="Sidebar-nav"><section><a href="/" class="Sidebar-NavLink Sidebar-nav-heading ">Junctions</a><a href="/why-another-router/" class="Sidebar-NavLink  ">Why another router?</a><a href="/why-another-static-site-generator/" class="Sidebar-NavLink  ">Why another static generator?</a></section><section><a href="/tutorial/" class="Sidebar-NavLink Sidebar-nav-heading Sidebar-NavLink-active">Tutorial</a><a href="/tutorial/#Creating-a-react-app" class="Sidebar-HashLink  ">Creating a React app</a><a href="/tutorial/#Templates" class="Sidebar-HashLink  ">Templates</a><a href="/tutorial/#The-JunctionNavigation-Component" class="Sidebar-HashLink  ">The JunctionNavigation component</a><a href="/tutorial/#Junctions-and-Pages" class="Sidebar-HashLink  ">Junctions and Pages</a><a href="/tutorial/#Rendering-Content" class="Sidebar-HashLink  ">Rendering content</a><a href="/tutorial/#Links" class="Sidebar-HashLink  ">Links</a><a href="/tutorial/#Markdown-Components" class="Sidebar-HashLink  ">Markdown components</a><a href="/tutorial/#Split-Content" class="Sidebar-HashLink  ">Split content</a><a href="/tutorial/#Static-Builds" class="Sidebar-HashLink  ">Static builds</a></section><section><div class="Sidebar-nav-heading">Guides</div><a href="/static-sites-with-create-react-app/" class="Sidebar-NavLink  ">Static builds with create-react-app</a></section><section class="Sidebar-api"><a href="/api-reference/" class="Sidebar-NavLink Sidebar-nav-heading ">API Reference</a><div class="Sidebar-nav-subheading">Templates</div><a href="/api-reference/#createPageTemplate" class="Sidebar-HashLink  ">createPageTemplate</a><a href="/api-reference/#createRedirectTemplate" class="Sidebar-HashLink  ">createRedirectTemplate</a><a href="/api-reference/#createJunctionTemplate" class="Sidebar-HashLink  ">createJunctionTemplate</a><div class="Sidebar-nav-subheading">Components</div><div class="Sidebar-ComponentLink"><a href="/api-reference/#JunctionActiveChild" class="Sidebar-HashLink  ">&lt;<!-- -->JunctionActiveChild<!-- -->&gt;</a></div><div class="Sidebar-ComponentLink"><a href="/api-reference/#JunctionNavigation" class="Sidebar-HashLink  ">&lt;<!-- -->JunctionNavigation<!-- -->&gt;</a></div><div class="Sidebar-ComponentLink"><a href="/api-reference/#Link" class="Sidebar-HashLink  ">&lt;<!-- -->Link<!-- -->&gt;</a></div><div class="Sidebar-nav-subheading">Types</div><a href="/api-reference/#Junction" class="Sidebar-HashLink  ">Junction</a><a href="/api-reference/#Page" class="Sidebar-HashLink  ">Page</a></section><section><a href="https://github.com/jamesknelson/junctions" class="Sidebar-NavLink Sidebar-nav-heading ">GitHub »</a></section></nav></div><button class="App-nav-hamburger"><div class="App-nav-hamburger-icon"></div></button></div><main class="App-content"><div class="MDXWrapper"><div class="
    MDXWrapper-LoadingIndicator
    MDXWrapper-LoadingIndicator-done
  "></div><div class="MDXWrapper-ready"><div><h1 id="Junctions-Tutorial:-Make-this-site" class="MDXWrapper-heading">Junctions Tutorial: Make this site<a href="#Junctions-Tutorial:-Make-this-site" class="MDXWrapper-heading-link ">#</a></h1><p>This tutorial will walk you through creating a small documentation website using create-react-app, react-junctions, and Markdown. In fact, it’ll actually walk you through creating <em>this</em> website. Cool, huh?</p><p><em>You can see the end result of this tutorial at its <a href="https://github.com/jamesknelson/junctions-tutorial" class=" ">companion repository</a>. If you get stuck, try comparing your code to this repo.</em></p><h2 id="Creating-a-react-app" class="MDXWrapper-heading">Creating a react app<a href="#Creating-a-react-app" class="MDXWrapper-heading-link ">#</a></h2><p>Let’s start out by installing create-react-app and react-junctions, and spinning up a fresh project:</p><pre class="language-bash"><code><span class="token comment"># Install the create-react-app command-line tool</span>
<span class="token function">npm</span> <span class="token function">install</span> -g create-react-app

<span class="token comment"># Create a new project under the `junctions-tutorial` directory</span>
create-react-app junctions-tutorial
<span class="token function">cd</span> junctions-tutorial

<span class="token comment"># Install junctions and react-junctions</span>
<span class="token function">npm</span> <span class="token function">install</span> --save junctions react-junctions

<span class="token comment"># Start a development server at http://localhost:3000</span>
<span class="token function">npm</span> run start
</code></pre><p>If all has gone well, this should have created a few files for you, and opened a browser window with a spinning React logo. So far, so good.</p><p>Now, we just need to add some templates!</p><h2 id="Templates" class="MDXWrapper-heading">Templates<a href="#Templates" class="MDXWrapper-heading-link ">#</a></h2><p>In a junctions-based app, <strong>templates</strong> are the objects that define your app’s URL structure. Here’s an example:</p><pre class="language-jsx"><code><span class="token keyword">let</span> ReadmeTemplate <span class="token operator">=</span> <span class="token function">createPageTemplate</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  title<span class="token punctuation">:</span> <span class="token string">'Junctions'</span><span class="token punctuation">,</span>
  component<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span>Junctions README<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>Blah blah blah<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><p>There are three types of templates:</p><ul><li><strong>Page templates</strong> define the pages that users can visit.</li><li><strong>Redirect templates</strong> specify redirects between URLs.</li><li><strong>Junction templates</strong> map URL parts to pages, redirects, and/or more junctions.</li></ul><h3 id="Let&#x27;s-add-a-template" class="MDXWrapper-heading">Let’s add a template<a href="#Let&#x27;s-add-a-template" class="MDXWrapper-heading-link ">#</a></h3><p>At the root of every app, you’ll need a <code>JunctionTemplate</code> that maps URLs to content. So let’s add one.</p><p>You’ll want to add it to <code>App.js</code>; the root React component lives there, so it makes sense that the root <code>JunctionTemplate</code> will too.</p><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> createJunctionTemplate<span class="token punctuation">,</span> createPageTemplate <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'junctions'</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> AppJunctionTemplate <span class="token operator">=</span> <span class="token function">createJunctionTemplate</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  children<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token string">'/'</span><span class="token punctuation">:</span> <span class="token function">createPageTemplate</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      title<span class="token punctuation">:</span> <span class="token string">'Junctions'</span><span class="token punctuation">,</span>
      component<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span>Junctions<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>

    <span class="token string">'/api-reference'</span><span class="token punctuation">:</span> <span class="token function">createPageTemplate</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      title<span class="token punctuation">:</span> <span class="token string">'Junctions API Reference'</span><span class="token punctuation">,</span>
      component<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span>Junctions API Reference<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  component<span class="token punctuation">:</span> App<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><p>This junction template says a few things:</p><ol><li>The app has two URLs: <code>/api-reference</code>, and <code>/</code> (the root URL)</li><li>The <code>App</code> component will be used to render these URLs</li><li>The two pages have titles, and should be rendered with the specified components.</li></ol><aside><div><h4 id="Why-call-them-&quot;templates&quot;-and-not-just-&quot;pages&quot;-or-&quot;junctions&quot;" class="MDXWrapper-heading">Why call them “templates”, and not just “pages” or “junctions”?<a href="#Why-call-them-&quot;templates&quot;-and-not-just-&quot;pages&quot;-or-&quot;junctions&quot;" class="MDXWrapper-heading-link ">#</a></h4><p>Each time the browser’s location changes, your templates are used to create new <a href="/api-reference/#Page" class=" ">Page</a> and <a href="/api-reference/#Junction" class=" ">Junction</a> objects. These contain information that can’t be set ahead of time in the templates, including a Page’s current URL, or a Junction’s active child.</p></div></aside><p>Now that you’ve defined <code>AppJunctionTemplate</code>, your app has the information it needs to render different content for different URLs. But how do you <em>use</em> this information?</p><h2 id="The-JunctionNavigation-Component" class="MDXWrapper-heading">The <code>&lt;JunctionNavigation&gt;</code> Component<a href="#The-JunctionNavigation-Component" class="MDXWrapper-heading-link ">#</a></h2><p>The <code>&lt;JunctionNavigation root={JunctionTemplate}&gt;</code> component keeps track of the browser’s current location, rendering the root junction’s component whenever the URL changes.</p><p>If you’re familiar with react-router, this is a bit like the <code>&lt;Router&gt;</code> <small>(v3)</small> or <code>&lt;BrowserRouter&gt;</code> <small>(v4)</small> component. The main difference is that <code>&lt;JunctionNavigation&gt;</code> also does a bit of housekeeping – managing the document title, scrolling to <code>#hash</code> links, and keeping track of code splits.</p><h3 id="Let&#x27;s-add-a-JunctionNavigation" class="MDXWrapper-heading">Let’s add a <code>&lt;JunctionNavigation&gt;</code><a href="#Let&#x27;s-add-a-JunctionNavigation" class="MDXWrapper-heading-link ">#</a></h3><p>By default, create-react-app starts the app by rendering an <code>&lt;App&gt;</code> element in <code>index.js</code>:</p><pre class="language-jsx"><code>ReactDOM<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>App</span> <span class="token punctuation">/></span></span><span class="token punctuation">,</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'root'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre><p>You’ll want to replace this <code>&lt;App&gt;</code> element with a <code>&lt;JunctionNavigation&gt;</code> element, passing in <code>AppJunctionTemplate</code> from the previous step as its <code>root</code> prop:</p><pre class="language-jsx"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> JunctionNavigation <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react-junctions'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> AppJunctionTemplate <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./App'</span>

<span class="token comment">// Instead of rendering `&lt;App>` directly, it will be rendered by</span>
<span class="token comment">// `&lt;JunctionNavigation>`.</span>
ReactDOM<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>JunctionNavigation</span> <span class="token attr-name">root</span><span class="token script language-javascript"><span class="token punctuation">=</span><span class="token punctuation">{</span>AppJunctionTemplate<span class="token punctuation">}</span></span> <span class="token punctuation">/></span></span><span class="token punctuation">,</span>
  document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'root'</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>
</code></pre><p>Go ahead - try making this change if you haven’t already. Once you’ve saved the file, create-react-app’s development server should automatically reload the page, and you should still see a spinning React logo.</p><p><em>But you shouldn’t see any change in the content!</em></p><p>The thing is, <code>&lt;JunctionNavigation&gt;</code> is just rendering <code>&lt;App&gt;</code>. And we haven’t changed touched the <code>App</code> class yet, so nothing <em>visible</em> has changed.</p><p>But one thing has changed: the <code>&lt;App&gt;</code> component is now receiving a <code>junction</code> prop.</p><h2 id="Junctions-and-Pages" class="MDXWrapper-heading">Junctions and Pages<a href="#Junctions-and-Pages" class="MDXWrapper-heading-link ">#</a></h2><p>When your <code>&lt;JunctionNavigation&gt;</code> component renders the <code>&lt;App&gt;</code> component, it passes it a <code>junction</code> prop. This prop contains the navigation state for your entire app, and looks a little like this:</p><div class="properties"><div><h4 id="Junction" class="MDXWrapper-heading"><code>Junction</code><a href="#Junction" class="MDXWrapper-heading-link ">#</a></h4><ul><li><strong><code>activeChild</code>:</strong> Holds a <code>Page</code> object, based on the active child from the junction’s <code>children</code> – or <code>undefined</code> if there is no active child.</li><li><strong><code>children</code>:</strong> <em>Copied from the junction template.</em></li><li><strong><code>component</code>:</strong> <em>Copied from the junction template.</em></li><li><strong><code>status</code>:</strong> Either <code>&quot;ready&quot;</code>, or <code>&quot;notfound&quot;</code>.</li></ul><p><a href="/api-reference#Junction" class=" ">See all properties »</a></p></div></div><p>Each <code>Junction</code> object is based on one of your Junction Templates, but has extra properties that are derived from the browser’s current URL – including <code>status</code> and <code>activeChild</code>.</p><p>The <code>activeChild</code> property is particularly important; it contains a <code>Page</code> object, with details on whichever page is selected by the current URL:</p><div class="properties"><div><h4 id="Page" class="MDXWrapper-heading"><code>Page</code><a href="#Page" class="MDXWrapper-heading-link ">#</a></h4><ul><li><strong><code>component</code>:</strong> <em>Copied from the page template.</em></li><li><strong><code>title</code>:</strong> <em>Copied from the page template.</em></li><li><strong><code>url</code>:</strong> The URL at which the page is mounted.</li></ul><p><a href="/api-reference#Page" class=" ">See all properties »</a></p></div></div><h2 id="Rendering-Content" class="MDXWrapper-heading">Rendering Content<a href="#Rendering-Content" class="MDXWrapper-heading-link ">#</a></h2><p>Now that your <code>App</code> component receives a <code>junction</code> prop, you can decide what to render by checking <code>this.props.junction.activeChild</code>.</p><p>Keeping in mind that <code>activeChild</code> may be <code>undefined</code>, your new App class may look something like this:</p><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">App</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
  <span class="token function">renderContent</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token punctuation">{</span> junction <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props

    <span class="token comment">// If there is a currently selected page, get its component.</span>
    <span class="token comment">// Use an uppercase `C` so the variable can be used in a JSX element.</span>
    <span class="token keyword">let</span> Component <span class="token operator">=</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>junction<span class="token punctuation">.</span>activeChild <span class="token operator">&amp;&amp;</span> 
      <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>junction<span class="token punctuation">.</span>activeChild<span class="token punctuation">.</span>component
    
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>Component<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// If the user enters an unknown URL, there will be no active child,</span>
      <span class="token comment">// and thus no component.</span>
      <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span><span class="token number">404</span><span class="token punctuation">:</span> Page Not Found<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span>
    <span class="token punctuation">}</span>
    <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token comment">// Render the page's component, passing in the active Page object</span>
      <span class="token comment">// as a prop.</span>
      <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Component</span> <span class="token attr-name">page</span><span class="token script language-javascript"><span class="token punctuation">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>junction<span class="token punctuation">.</span>activeChild<span class="token punctuation">}</span></span> <span class="token punctuation">/></span></span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>App<span class="token punctuation">'</span></span><span class="token punctuation">></span></span>
        <span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">renderContent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
    <span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><p>Once you’ve made this change and saved the file, your site should display the index page’s content. And if you change the browser’s URL to <code>http://localhost:3000/api-reference</code>, the heading should change too.</p><p>Did your app work as expected? If not, you’ll want to figure out what is wrong before continuing, as this step is crucial to making a working app.</p><p>So does your app work? In that case, congratulations! You’ve built a working app with Junctions!</p><h2 id="Links" class="MDXWrapper-heading">Links<a href="#Links" class="MDXWrapper-heading-link ">#</a></h2><p>Because junctions produces static files, you <em>can</em> create links with HTML <code>&lt;a&gt;</code> tags. But they won’t be ideal.</p><p>The thing about <code>&lt;a&gt;</code> tags is that they’ll cause the browser to completely reload the page. For example, you can try clicking on the link below, which goes to the <em>Links</em> heading above:</p><p><code>&lt;a href=&quot;/tutorial#Links&quot;&gt;</code><a href="/tutorial#Links">Tutorial / Links</a><code>&lt;/a&gt;</code></p><p>When clicking this link, you may notice a flash of no content as the browser reloads the page. <small>(Or you might not, because Junctions generates ridiculously fast websites.)</small></p><p>To solve this, you can use the HTML5 History API’s <a href="https://developer.mozilla.org/en-US/docs/Web/API/History_API#The_pushState()_method" class=" ">pushState</a> method. This method changes the URL in the browser’s location bar, <em>without</em> reloading the page.</p><p>But writing your own <code>pushState</code> code wouldn’t be much fun, which is why Junctions gives you a <code>&lt;Link&gt;</code> component. This component behaves like <code>&lt;a&gt;</code>, but uses <code>pushState</code> internally. Notice the speed difference when you click this link:</p><p><code>&lt;Link href=&quot;/tutorial#Links&quot;&gt;</code><a href="/tutorial#Links" class=" ">Tutorial / Links</a><code>&lt;/Link&gt;</code></p><h3 id="Let&#x27;s-add-a-navbar" class="MDXWrapper-heading">Let’s add a navbar<a href="#Let&#x27;s-add-a-navbar" class="MDXWrapper-heading-link ">#</a></h3><p>The navbar on the left of this page is chock-full of links. So let’s test out the <code>&lt;Link&gt;</code> component by creating an unstyled <code>&lt;Navbar&gt;</code>:</p><pre class="language-jsx"><code><span class="token comment">// src/Navbar.jsx</span>
<span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">'react'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Link <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react-junctions'</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">Navbar</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>Navbar<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Link</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>/<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Junctions<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Link</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Link</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>/api-reference<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>API Reference<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Link</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">></span></span>
</code></pre><p>Where should this <code>&lt;Navbar&gt;</code> element be rendered from? One possibility would be to add it to each of your page’s components. But as the site grows, this would become painful.</p><p>Instead, it makes sense to render the <code>&lt;Navbar&gt;</code> element from the <code>&lt;App&gt;</code> component, along with the current page. Here’s an example:</p><pre class="language-jsx"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Navbar <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./Navbar'</span>

<span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>App<span class="token punctuation">'</span></span><span class="token punctuation">></span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Navbar</span> <span class="token punctuation">/></span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>App-content<span class="token punctuation">'</span></span><span class="token punctuation">></span></span>
        <span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">renderContent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><h2 id="Markdown-Components" class="MDXWrapper-heading">Markdown Components<a href="#Markdown-Components" class="MDXWrapper-heading-link ">#</a></h2><p>If you’re creating a documentation website, you’ll probably want to write your content in a plain-text format like <a href="https://daringfireball.net/projects/markdown/" class=" ">Markdown</a>. <small>HTML is great, but the 42nd time you have to type out &lt;p&gt; is just so…</small></p><p>The problem, of course, is that Junctions doesn’t expect plain-text content; it expects pages to provide a React Component.</p><p>One possible solution would be to load your content as text, and render it with a component like <a href="https://github.com/acdlite/react-remarkable" class=" ">react-remarkable</a>. And while this works, it has one major problem: your links will be plain-old <code>&lt;a&gt;</code> elements. And they’ll be <em>slow</em>.</p><p>Instead, you’ll want to convert your Markdown directly into a React component with <code>&lt;Link&gt;</code> elements for links. There are two ways to do this:</p><ul><li>At runtime, using <a href="https://github.com/rexxars/react-markdown" class=" ">react-markdown</a>.</li><li>At build time, using <a href="https://github.com/jamesknelson/mdx-loader" class=" ">mdx-loader</a>.</li></ul><p>I recommend doing that conversion at build time, as it produces smaller builds, faster responses, and also allows you to import files and use JSX within your markdown. <small>Disclaimer: I created mdx-loader.</small></p><h3 id="Let&#x27;s-add-a-Markdown-page" class="MDXWrapper-heading">Let’s add a Markdown page<a href="#Let&#x27;s-add-a-Markdown-page" class="MDXWrapper-heading-link ">#</a></h3><p>To start, you’ll need to add a couple packages to your project:</p><pre class="language-bash"><code><span class="token function">npm</span> <span class="token function">install</span> --save-dev mdxc mdx-loader
</code></pre><p>You’ll also need to add this <code>.babelrc</code> to the root directory of your project:</p><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">"presets"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"babel-preset-react-app"</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre><p>With this setup complete, you can now import Markdown files as if they were React components!</p><hr/><p>To test this out, you’ll first need a Markdown file. I like to place my site’s markdown files under a <code>src/content</code> directory, so let’s add a <code>src/content/index.md</code> file:</p><pre class="language-markdown"><code><span class="token title important">Junctions
<span class="token punctuation">=========</span></span>

<span class="token bold"><span class="token punctuation">**</span>A batteries-included router for React.<span class="token punctuation">**</span></span>

<span class="token title important"><span class="token punctuation">##</span> Documentation</span>

<span class="token list punctuation">-</span> <span class="token url">[API Reference](/api-reference)</span>
</code></pre><p>You can then import the document as a React component by prefixing the filename with <code>!babel-loader!mdx-loader!</code>. This tells Webpack to run <code>index.md</code> through MDX, and then Babel, before importing the resulting JavaScript.</p><p>You’ll also need to tell eslint that it is ok to use the Webpack <code>!</code> syntax; make sure that the following comment goes at the very top of your file!</p><pre class="language-jsx"><code><span class="token comment">/* eslint-disable import/no-webpack-loader-syntax */</span>
<span class="token keyword">import</span> IndexDocument <span class="token keyword">from</span> <span class="token string">'!babel-loader!mdx-loader!./content/index.md'</span>
</code></pre><p>Finally, set your index page’s <code>component</code> property to <code>IndexDocument</code> and refresh the page; you should see the contents of your new Markdown file!</p><h3 id="Configuring-the-Markdown-link-component" class="MDXWrapper-heading">Configuring the Markdown link component<a href="#Configuring-the-Markdown-link-component" class="MDXWrapper-heading-link ">#</a></h3><p>By default, MDX uses vanilla <code>&lt;a&gt;</code> tags for links – but we want to use <code>&lt;Link&gt;</code> elements to improve performance.</p><p>Luckily, MDX allows you to configure <a href="https://github.com/jamesknelson/mdxc#factories" class=" ">factories</a> for each type of markup that it can produce. To do so, you just pass a <code>factories</code> prop to the document component.</p><p>For example, here’s how you’d create an <code>IndexDocumentWrapper</code> component that renders its links as JSX <code>&lt;Link&gt;</code> elements:</p><pre class="language-jsx"><code><span class="token comment">// Define factories outside of the component, so that the factories aren't</span>
<span class="token comment">// re-created each time the document renders</span>
<span class="token keyword">let</span> factories <span class="token operator">=</span> <span class="token punctuation">{</span>
  a<span class="token punctuation">:</span> <span class="token punctuation">(</span>props<span class="token punctuation">,</span> <span class="token operator">...</span>children<span class="token punctuation">)</span> <span class="token operator">=></span>
    React<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span>Link<span class="token punctuation">,</span> props<span class="token punctuation">,</span> <span class="token operator">...</span>children<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> <span class="token function-variable function">IndexDocumentWrapper</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>IndexDocument</span> <span class="token attr-name">factories</span><span class="token script language-javascript"><span class="token punctuation">=</span><span class="token punctuation">{</span>factories<span class="token punctuation">}</span></span> <span class="token punctuation">/></span></span>
</code></pre><p>By using <code>IndexDocumentWrapper</code> as your index page <code>component</code>, you’ll ensure that the page’s links are just as snappy as any other links within your application.</p><p>You can also use MDX factories to configure other behaviors. For example, you could use factories to add <code>#hash</code> links to each of your document’s headings.</p><p>But while factories give you flexibility, they’re also rather verbose. Creating a new wrapper component for each page would quickly get tiresome. But luckily, you don’t have to!</p><h2 id="Split-Content" class="MDXWrapper-heading">Split Content<a href="#Split-Content" class="MDXWrapper-heading-link ">#</a></h2><p>Up until now, this tutorial has only used a subset of the available options for page templates. In fact, you can configure more than just a <code>title</code> and a <code>component</code>; you can see the full suite of options in the <a href="/api-reference/#createPageTemplate" class=" ">API Reference</a>.</p><p>There is one option in particular that comes in handy: <code>getContent</code>. This option lets you specify a function that returns your content, or a <em>promise</em> to your content. The function will then be called the first time the page is loaded.</p><p>Your content can be anything – a text file, a React component, or even a module returned by ESNext’s proposed <code>import</code> syntax. And once your content is available, it can be accessed by the page’s component under the <code>content</code> property of your Page object.</p><p>For example, here’s how you’d use <code>getContent</code> and <code>import()</code> to dynamically load a markdown file when the page is first accessed:</p><pre class="language-jsx"><code><span class="token function">createPageTemplate</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  title<span class="token punctuation">:</span> <span class="token string">'Junctions API Reference'</span><span class="token punctuation">,</span>

  getContent<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span>
    <span class="token comment">// `import()` returns a promise to an object with all of the module's</span>
    <span class="token comment">// exports.</span>
    <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'!babel-loader!mdx-loader!./content/api-reference.md'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>

  <span class="token comment">// When the import statement completes, the loaded module will be available</span>
  <span class="token comment">// under `page.content`.</span>
  component<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> page <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=></span>
    <span class="token operator">!</span>page<span class="token punctuation">.</span>content
      <span class="token operator">?</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span>Loading<span class="token operator">...</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
      <span class="token punctuation">:</span> React<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span>page<span class="token punctuation">.</span>content<span class="token punctuation">.</span><span class="token keyword">default</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
</code></pre><h3 id="Content-Wrapper-Components" class="MDXWrapper-heading">Content Wrapper Components<a href="#Content-Wrapper-Components" class="MDXWrapper-heading-link ">#</a></h3><p>Now that your page’s content has been separated from the component that renders it, it is possible to create a single Wrapper component that can be shared over all markdown pages.</p><p>You have a lot of flexibility in how you implement this. You can add loading spinners, error messages, markdown factories, menus, and a bunch of other bits and pieces.</p><p>For example, here’s a stripped-down version of the <a href="https://github.com/jamesknelson/junctions/blob/master/site/src/MDXWrapper.js" class=" ">wrapper component</a> for this website. It makes use of the Page object’s <code>contentStatus</code> property to give the user feedback on the content’s status.</p><pre class="language-jsx"><code><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">'react'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Link <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react-junctions'</span>

<span class="token keyword">function</span> <span class="token function">createHeadingFactory</span><span class="token punctuation">(</span>type<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>props<span class="token punctuation">,</span> <span class="token operator">...</span>children<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> React<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span>
      type<span class="token punctuation">,</span>
      props<span class="token punctuation">,</span>
      <span class="token operator">...</span>children<span class="token punctuation">,</span>
      <span class="token comment">// Append a hash link to each heading, which will be hidden via</span>
      <span class="token comment">// CSS until he mouse hovers over the heading.</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Link</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>heading-link<span class="token punctuation">'</span></span> <span class="token attr-name">href</span><span class="token script language-javascript"><span class="token punctuation">=</span><span class="token punctuation">{</span><span class="token string">'#'</span><span class="token operator">+</span>props<span class="token punctuation">.</span>id<span class="token punctuation">}</span></span><span class="token punctuation">></span></span>#<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Link</span><span class="token punctuation">></span></span>
    <span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">MarkdownWrapper</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
  factories <span class="token operator">=</span> <span class="token punctuation">{</span>
    a<span class="token punctuation">:</span> <span class="token punctuation">(</span>props<span class="token punctuation">,</span> <span class="token operator">...</span>children<span class="token punctuation">)</span> <span class="token operator">=></span>
      React<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span>Link<span class="token punctuation">,</span> props<span class="token punctuation">,</span> <span class="token operator">...</span>children<span class="token punctuation">)</span><span class="token punctuation">,</span>

    h1<span class="token punctuation">:</span> <span class="token function">createHeadingFactory</span><span class="token punctuation">(</span><span class="token string">'h1'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    h2<span class="token punctuation">:</span> <span class="token function">createHeadingFactory</span><span class="token punctuation">(</span><span class="token string">'h2'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    h3<span class="token punctuation">:</span> <span class="token function">createHeadingFactory</span><span class="token punctuation">(</span><span class="token string">'h3'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span>
 
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> page <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>page
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>MarkdownWrapper<span class="token punctuation">'</span></span><span class="token punctuation">></span></span>
        <span class="token punctuation">{</span> page<span class="token punctuation">.</span>contentStatus <span class="token operator">===</span> <span class="token string">'busy'</span> <span class="token operator">&amp;&amp;</span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>page-loading<span class="token punctuation">'</span></span> <span class="token punctuation">/></span></span>
        <span class="token punctuation">}</span>
        <span class="token punctuation">{</span> page<span class="token punctuation">.</span>contentStatus <span class="token operator">===</span> <span class="token string">'ready'</span> <span class="token operator">&amp;&amp;</span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>page-ready<span class="token punctuation">'</span></span><span class="token punctuation">></span></span>
            <span class="token punctuation">{</span>React<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span>page<span class="token punctuation">.</span>content<span class="token punctuation">.</span><span class="token keyword">default</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
              factories<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>factories<span class="token punctuation">,</span>
              page<span class="token punctuation">:</span> page<span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
        <span class="token punctuation">}</span>
        <span class="token punctuation">{</span> page<span class="token punctuation">.</span>contentStatus <span class="token operator">===</span> <span class="token string">'error'</span> <span class="token operator">&amp;&amp;</span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>page-error<span class="token punctuation">'</span></span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span>Gosh darn it<span class="token punctuation">.</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
        <span class="token punctuation">}</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
    <span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><p>Once you have a Markdown wrapper component, you can use it in a page template’s <code>component</code> property:</p><pre class="language-jsx"><code><span class="token function">createPageTemplate</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  title<span class="token punctuation">:</span> <span class="token string">'Junctions API Reference'</span><span class="token punctuation">,</span>
  component<span class="token punctuation">:</span> MarkdownComponent<span class="token punctuation">,</span>
  getContent<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span>
    <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'!babel-loader!mdx-loader!./content/api-reference.md'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
</code></pre><p>Congratulations on getting this far through the tutorial! By now, you’ve learned everything you need to re-create this website – at least within create-react-app’s development server!</p><p>The only thing left to do is to turn your site into a production-ready static website!</p><h2 id="Static-Builds" class="MDXWrapper-heading">Static Builds<a href="#Static-Builds" class="MDXWrapper-heading-link ">#</a></h2><p>To create a static website from a junctions app, you’ll first need to add the <code>junctions-static</code> package to your app:</p><pre class="language-bash"><code><span class="token function">npm</span> <span class="token function">install</span> --save-dev junctions-static
</code></pre><p>This package includes a command-line tool that loads the output of CRA’s <code>build</code> script, then walks through each junction template’s children to find your app’s URLs.</p><p>You can call the command line tool manually, by I recommend adding it to the end of the <code>build</code> script in <code>package.json</code>. Here’s what the resulting line will look like:</p><pre class="language-json"><code><span class="token property">"build"</span><span class="token operator">:</span> <span class="token string">"react-scripts build &amp;&amp; junctions-static build -m build/static/js/main.*.js -r create-react-app"</span><span class="token punctuation">,</span>
</code></pre><h3 id="Changes-to-index.js" class="MDXWrapper-heading">Changes to <code>index.js</code><a href="#Changes-to-index.js" class="MDXWrapper-heading-link ">#</a></h3><p>To get the static build working, you’ll need to make some changes to your app’s entry point. Here’s an example of a modified <code>index.js</code>; I’ll go through the changes one-by-one after the code listing.</p><pre class="language-jsx"><code><span class="token keyword">function</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> content <span class="token operator">=</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>JunctionNavigation</span>
      <span class="token attr-name">root</span><span class="token script language-javascript"><span class="token punctuation">=</span><span class="token punctuation">{</span>AppJunctionTemplate<span class="token punctuation">}</span></span>
      <span class="token attr-name">waitForInitialContent</span>
    <span class="token punctuation">/></span></span>

  <span class="token keyword">let</span> node <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'root'</span><span class="token punctuation">)</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span>NODE_ENV <span class="token operator">===</span> <span class="token string">'production'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    ReactDOM<span class="token punctuation">.</span><span class="token function">hydrate</span><span class="token punctuation">(</span>content<span class="token punctuation">,</span> node<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">else</span> <span class="token punctuation">{</span>
    ReactDOM<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span>content<span class="token punctuation">,</span> node<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span>NODE_ENV <span class="token operator">!==</span> <span class="token string">'production'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token function">registerServiceWorker</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

window<span class="token punctuation">.</span>JunctionsStaticApp <span class="token operator">=</span> <span class="token punctuation">{</span>
  root<span class="token punctuation">:</span> AppJunctionTemplate<span class="token punctuation">,</span>
  main<span class="token punctuation">:</span> main
<span class="token punctuation">}</span>
</code></pre><h4 id="1.-Add-a-main-function" class="MDXWrapper-heading">1. Add a <code>main</code> function<a href="#1.-Add-a-main-function" class="MDXWrapper-heading-link ">#</a></h4><p>Because junctions-static loads your app from a Node environment, you won’t want your app to follow its normal boot process in a static build.</p><p>To solve this, I recommend moving the contents of <code>index.js</code> into a <code>main()</code> function, and only calling that function when running from CRA’s development server.</p><pre class="language-js"><code><span class="token keyword">if</span> <span class="token punctuation">(</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span>NODE_ENV <span class="token operator">!==</span> <span class="token string">'production'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token function">registerServiceWorker</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><h4 id="2.-Call-ReactDOM.hydrate-in-production" class="MDXWrapper-heading">2. Call <code>ReactDOM.hydrate</code> in production<a href="#2.-Call-ReactDOM.hydrate-in-production" class="MDXWrapper-heading-link ">#</a></h4><p>This method is just like <code>ReactDOM.render</code>, but it lets React know that the<!-- -->content has been statically rendered, and is already available in the DOM.</p><pre class="language-js"><code>ReactDOM<span class="token punctuation">.</span><span class="token function">hydrate</span><span class="token punctuation">(</span>content<span class="token punctuation">,</span> node<span class="token punctuation">)</span>
</code></pre><h4 id="3.-Export-your-root-junction-template-and-main" class="MDXWrapper-heading">3. Export your root junction template and <code>main()</code> function<a href="#3.-Export-your-root-junction-template-and-main" class="MDXWrapper-heading-link ">#</a></h4><p>Junctions-static can’t find your application’s junctions unless you tell it where they are. Likewise, it can’t call the <code>main()</code> function unless it has access to it.</p><p>To solve this, you’ll need to export your junction template and <code>main</code> function by adding them to the global <code>window</code> object.</p><pre class="language-js"><code>window<span class="token punctuation">.</span>JunctionsStaticApp <span class="token operator">=</span> <span class="token punctuation">{</span>
  root<span class="token punctuation">:</span> AppJunctionTemplate<span class="token punctuation">,</span>
  main<span class="token punctuation">:</span> main
<span class="token punctuation">}</span>
</code></pre><h4 id="4.-Add-the-waitForInitialContent-prop-to-JunctionNavigation" class="MDXWrapper-heading">4. Add the <code>waitForInitialContent</code> prop to <code>&lt;JunctionNavigation&gt;</code><a href="#4.-Add-the-waitForInitialContent-prop-to-JunctionNavigation" class="MDXWrapper-heading-link ">#</a></h4><p>This prop tells Junctions to wait for your initial page’s content promise to resolve before rendering any content. This ensures that you don’t see a loading message while the first page is loading.</p><pre class="language-jsx"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>JunctionNavigation</span>
  <span class="token attr-name">root</span><span class="token script language-javascript"><span class="token punctuation">=</span><span class="token punctuation">{</span>AppJunctionTemplate<span class="token punctuation">}</span></span>
  <span class="token attr-name">waitForInitialContent</span>
<span class="token punctuation">/></span></span>
</code></pre><h3 id="Congratulations!" class="MDXWrapper-heading">Congratulations!<a href="#Congratulations!" class="MDXWrapper-heading-link ">#</a></h3><p>With these changes, your build should now work! To test it out, just run:</p><pre class="language-bash"><code><span class="token function">npm</span> run build
</code></pre><p>And then follow CRA’s instructions to start a build server!</p><p>There’s just one thing left to do. If you open your site in a browser, Junctions will update the document title to “Junctions”… but not before flashing CRA’s default title for a split second.</p><p>To makes sure that each of your page’s files has the correct title, change the <code>&lt;title&gt;</code> line in <code>public/index.html</code> to the following:</p><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>%PAGE_TITLE%<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>
</code></pre><p>In fact, if you add a <code>meta</code> property to your page templates, you’ll be able to access any of its values using the <code>%template%</code> syntax within <code>index.html</code>. You can see this in action in <a href="https://github.com/jamesknelson/junctions/blob/master/site/public/index.html" class=" ">the source</a> for this site’s <code>index.html</code>.</p><p>And with that, you’re ready to start building sites with junctions. Congratulations!</p></div></div></div></main></div></div></div>
    <!--
      This HTML file is a template.
      If you open it directly in the browser, you will see an empty page.

      You can add webfonts, meta tags, or analytics to this file.
      The build step will place the bundled scripts into the <body> tag.

      To begin the development, run `npm start` or `yarn start`.
      To create a production bundle, use `npm run build` or `yarn build`.
    -->
  <script src="/static/js/main.ab0ffaad.js"></script><script src="/static/js/2.9e2b1b12.chunk.js"></script><script>window.JunctionsStaticApp.main()</script>
</html>
